---
// 联系方式按钮组件
interface Props {
  t?: {
    contactNow?: string;
    email?: string;
    telephone?: string;
    whatsapp?: string;
    downloadPdf?: string;
  };
  showContactNow?: boolean;
  showEmail?: boolean;
  showTelephone?: boolean;
  showWhatsapp?: boolean;
  showDownloadPdf?: boolean;
}

const { 
  t,
  showContactNow = true,
  showEmail = true,
  showTelephone = true,
  showWhatsapp = true,
  showDownloadPdf = true
} = Astro.props;

// 默认文案（英文）
const defaultTexts = {
  contactNow: "Contact Now",
  email: "E-Mail",
  telephone: "Telephone",
  whatsapp: "WhatsApp",
  downloadPdf: "Download PDF"
};

// 使用传入的翻译或默认文案
const texts = {
  contactNow: t?.contactNow || defaultTexts.contactNow,
  email: t?.email || defaultTexts.email,
  telephone: t?.telephone || defaultTexts.telephone,
  whatsapp: t?.whatsapp || defaultTexts.whatsapp,
  downloadPdf: t?.downloadPdf || defaultTexts.downloadPdf
};
---

<div class="contact-buttons-container">
  <div class="flex flex-wrap gap-4 justify-center">
    <!-- Contact Now 按钮 - 修改为触发模态框 -->
    {showContactNow && (
              <button 
           type="button"
           class="contact-btn bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 flex items-center gap-2 transition-colors duration-300 min-w-[160px] justify-center text-sm"
           onclick="openContactModal()"
        >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
        </svg>
        {texts.contactNow}
      </button>
    )}

    <!-- Download PDF 按钮 -->
    {showDownloadPdf && (
      <button 
        type="button"
        class="contact-btn bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 flex items-center gap-2 transition-colors duration-300 min-w-[160px] justify-center text-sm"
        onclick="openDownloadModal()"
      >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd"/>
        </svg>
        {texts.downloadPdf}
      </button>
    )}

    <!-- E-Mail 按钮 -->
    {showEmail && (
      <a href="mailto:leiyang0501@163.com" 
         class="contact-btn bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 flex items-center gap-2 transition-colors duration-300 min-w-[160px] justify-center text-sm">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
          <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
        </svg>
        {texts.email}
      </a>
    )}

    <!-- Telephone 按钮 -->
    {showTelephone && (
      <a href="tel:+8615069038877" 
         class="contact-btn bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 flex items-center gap-2 transition-colors duration-300 min-w-[160px] justify-center text-sm">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.773a11.037 11.037 0 006.105 6.105l.774-1.548a1 1 0 011.059-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"/>
        </svg>
        {texts.telephone}
      </a>
    )}

    <!-- WhatsApp 按钮 -->
    {showWhatsapp && (
      <a href="https://wa.me/8618353161619" 
         target="_blank"
         rel="noopener noreferrer"
         class="contact-btn bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 flex items-center gap-2 transition-colors duration-300 min-w-[160px] justify-center text-sm">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
        </svg>
        {texts.whatsapp}
      </a>
    )}
  </div>
</div>

<style>
  .contact-btn {
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    text-decoration: none;
    font-size: 1.1rem;
    letter-spacing: 0.025em;
  }

  .contact-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  .contact-buttons-container {
    padding: 2rem 0;
  }

  @media (max-width: 768px) {
    .contact-btn {
      min-width: 140px;
      margin-bottom: 0.5rem;
      font-size: 0.875rem;
    }
    
    .contact-buttons-container .flex {
      flex-wrap: wrap;
      gap: 0.5rem;
    }
  }

  @media (min-width: 769px) and (max-width: 1024px) {
    .contact-btn {
      min-width: 180px;
      font-size: 1rem;
      padding: 0.875rem 1.5rem;
    }
  }
</style>

<script>
  // 全局变量来跟踪是否应该下载PDF
  let shouldDownloadPdf = false;

  // 将openDownloadModal定义为全局函数
  (window as any).openDownloadModal = function() {
    // 设置标志，表示这是下载请求
    shouldDownloadPdf = true;
    
    // 使用ContactModal组件提供的openContactModal函数
    if ((window as any).openContactModal) {
      (window as any).openContactModal();
    }
  };

  // 监听表单提交成功事件
  document.addEventListener('DOMContentLoaded', function() {
    // 监听自定义事件，当表单提交成功时触发
    document.addEventListener('contactFormSubmitted', function(e) {
      if (shouldDownloadPdf) {
        // 重置标志
        shouldDownloadPdf = false;
        
        // 延迟一下再下载，让用户看到成功消息
        setTimeout(() => {
          // 创建下载链接
          const link = document.createElement('a');
          link.href = '/catalog.pdf';
          link.target = '_blank';
          link.rel = 'noopener noreferrer';
          link.download = 'catalog.pdf';
          
          // 触发下载
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }, 1500);
      }
    });
  });
</script> 