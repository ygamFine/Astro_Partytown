---
import Header from "../components/Header.astro";
import FooterSection from "../components/FooterSection.astro";

export interface Props {
  title: string;
  description?: string;
}

const {
  title,
  description = "山东永安建设机械集团有限公司 - 专业工程机械制造商",
} = Astro.props;
---

<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <!-- 性能提示 -->
    <meta name="theme-color" content="#dc2626" />
    <meta name="color-scheme" content="light" />
    
    <!-- 关键资源预加载 - LCP优化 -->
    <link rel="preload" href="/images/optimized/banner3.webp" as="image" type="image/webp" fetchpriority="high" />
    
    <!-- SEO优化 -->
    <meta name="keywords" content="滑移装载机,工程机械,建筑设备,山东永安,YONAN" />
    <meta name="author" content="山东永安建设机械集团有限公司" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />

    <!-- 超级精简的关键CSS - 仅LCP -->
    <style>
      *{margin:0;padding:0;box-sizing:border-box}
      html{font-size:10px}
      body{font-family:system-ui,sans-serif;line-height:1.5;color:#333;background:#fff}
      
      /* Banner关键样式 - 防止CLS */
      .banner-container{position:relative;width:100%;height:400px;overflow:hidden;background:#f5f5f5}
      @media (max-width:768px){.banner-container{height:250px}}
      .banner-slide{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;transition:opacity 0.5s}
      .banner-slide.active{opacity:1}
      .banner-slide img{width:100%;height:100%;object-fit:cover;display:block}
      
      /* Header基础 */
      .tevis-header{position:relative;z-index:50}
      .main-header{background:#374151;color:#fff;height:99px}
      @media (max-width:768px){.main-header{background:#334155;height:60px}}
      .header-content{display:flex;align-items:center;justify-content:space-between;height:100%}
      .nav-menu{background:#dc2626;height:60px}
      .mobile-menu.hidden{display:none}
      
      /* 加载指示器 */
      .loading{opacity:0;pointer-events:none}
    </style>

    <title>{title}</title>
  </head>
  <body>
    <Header />
    
    <main id="main-content">
      <slot />
    </main>

    <FooterSection />

    <!-- 延迟加载所有非关键资源 -->
    <script>
      // 页面加载完成后再加载样式和脚本
      window.addEventListener('load', function() {
        setTimeout(function() {
          // 加载CSS
          var link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = '/_astro/index.css';
          document.head.appendChild(link);
          
          // 加载所有组件脚本
          var scripts = [
            '/_astro/header.js',
            '/_astro/banner.js', 
            '/_astro/footer.js'
          ];
          
          scripts.forEach(function(src, index) {
            setTimeout(function() {
              var script = document.createElement('script');
              script.src = src;
              script.async = true;
              document.head.appendChild(script);
            }, index * 100);
          });
        }, 500);
      });
      
      // 超级延迟的第三方脚本
      setTimeout(function() {
        // Google Analytics
        var ga = document.createElement('script');
        ga.async = true;
        ga.src = 'https://www.googletagmanager.com/gtag/js?id=G-71JP66YM5X';
        document.head.appendChild(ga);
        
        ga.onload = function() {
          (window as any).dataLayer = (window as any).dataLayer || [];
          function gtag(...args: any[]){((window as any).dataLayer).push(args);}
          gtag('js', new Date());
          gtag('config', 'G-71JP66YM5X');
        };
        
        // 客服系统
        var cs = document.createElement("script");
        cs.src = "https://oss.huazhi.cloud/hzchat/dist/livechat.js";
        cs.async = true;
        document.head.appendChild(cs);
      }, 8000);
    </script>
  </body>
</html>
