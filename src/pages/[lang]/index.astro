---
export const prerender = true;
export const revalidate = 3600; // 1小时

import Layout from '../../layouts/Layout.astro';
import FullScreenBanner from '../../components/common/banner/FullScreenBanner.astro';
import HeroShowcase from '../../components/common/banner/HeroShowcase.astro';
import ProductShowcase from '../../components/ProductShowcase.astro';
import CustomerNeeds from '../../components/CustomerNeeds.astro';
import CustomerCases from '../../components/CustomerCases.astro';
import NewsCenter from '../../components/NewsCenter.astro';
import HotRecommendedProducts from '../../components/HotRecommendedProducts.astro';
import StatsSection from '../../components/StatsSection.astro';

import { themeConfig } from '../../config/theme.js';
import { generateStaticPaths } from '../../lib/i18n-routes.js';
import { getHomepageContent, getBannerData } from '../../lib/strapi.js';
import getDictionary from '../../i18n/dictionaries.ts';

// 使用 Astro 内置的 i18n 路由
export async function getStaticPaths() {
  return generateStaticPaths();
}

const { lang } = Astro.params;
const t = getDictionary(lang);

// 获取首页数据
const homepageData = await getHomepageContent();
const bannerData = await getBannerData();

// 获取页面宽度配置
const getPageWidth = () => {
  return themeConfig.layout.dynamicWidth.getPageWidth('home');
};

const pageWidth = getPageWidth();
---

<Layout title={t.nav.home} lang={lang} pageType="home">
	<main>
		<FullScreenBanner bannerData={bannerData} />
		<div class="container mx-auto px-4" style={`max-width: ${pageWidth}`}>
			<HeroShowcase bannerData={bannerData} />
			<ProductShowcase 
				title={homepageData?.productShowcase?.title}
				description={homepageData?.productShowcase?.description}
			/>
			<StatsSection 
				companyData={homepageData?.companyIntroduction}
			/>
			<HotRecommendedProducts 
				title={homepageData?.hotRecommendedProducts?.title}
				description={homepageData?.hotRecommendedProducts?.description}
			/>
			<CustomerNeeds 
				contactData={homepageData?.contactUs}
			/>
			<CustomerCases />
			<NewsCenter />
		</div>
	</main>
</Layout>
