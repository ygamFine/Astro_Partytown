# ğŸš€ Vercel + Strapi Webhook å¿«é€Ÿé…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è§ˆ
**ç›®æ ‡**: 5åˆ†é’Ÿå†…å®ŒæˆVerceléƒ¨ç½² + Strapi Webhookè‡ªåŠ¨æ›´æ–°é…ç½®

**æ•ˆæœ**: Strapiæ•°æ®æ›´æ–° â†’ 1-2ç§’è§¦å‘ â†’ 2-3åˆ†é’Ÿå®Œæˆéƒ¨ç½² â†’ ç½‘ç«™è‡ªåŠ¨æ›´æ–°

---

## ğŸ”§ ç¬¬ä¸€æ­¥: Verceléƒ¨ç½² (2åˆ†é’Ÿ)

### 1.1 å®‰è£…Vercel CLI
```bash
npm install -g vercel
```

### 1.2 ç™»å½•å¹¶éƒ¨ç½²
```bash
# ç™»å½•Vercel (ä¼šæ‰“å¼€æµè§ˆå™¨)
vercel login

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
vercel --prod
```

**éƒ¨ç½²è¿‡ç¨‹ä¸­çš„é€‰æ‹©:**
- `Set up and deploy?` â†’ **Yes**
- `Which scope?` â†’ é€‰æ‹©æ‚¨çš„è´¦æˆ·
- `Link to existing project?` â†’ **No** 
- `What's your project's name?` â†’ è¾“å…¥é¡¹ç›®å (å¦‚: `astro-strapi-site`)
- `In which directory is your code located?` â†’ **./** (å½“å‰ç›®å½•)
- `Want to override the settings?` â†’ **No**

### 1.3 è®°å½•éƒ¨ç½²ä¿¡æ¯
éƒ¨ç½²å®Œæˆåï¼Œè®°å½•ä»¥ä¸‹ä¿¡æ¯:
- **ç”Ÿäº§URL**: `https://your-project.vercel.app`
- **é¡¹ç›®å**: åœ¨Vercelæ§åˆ¶å°ä¸­æ˜¾ç¤º

---

## ğŸ”— ç¬¬äºŒæ­¥: è·å–Deploy Hook (1åˆ†é’Ÿ)

### 2.1 è¿›å…¥Vercel Dashboard
1. è®¿é—®: https://vercel.com/dashboard
2. ç‚¹å‡»æ‚¨åˆšåˆ›å»ºçš„é¡¹ç›®

### 2.2 åˆ›å»ºDeploy Hook
1. ç‚¹å‡» **Settings** æ ‡ç­¾
2. å·¦ä¾§èœå•é€‰æ‹© **Git**
3. æ‰¾åˆ° **Deploy Hooks** éƒ¨åˆ†
4. ç‚¹å‡» **Create Hook**
5. å¡«å†™é…ç½®:
   - **Hook Name**: `Strapi Content Update`
   - **Git Branch**: `main` (æˆ–æ‚¨çš„é»˜è®¤åˆ†æ”¯)
6. ç‚¹å‡» **Create Hook**
7. **å¤åˆ¶ç”Ÿæˆçš„URL** (ç±»ä¼¼: `https://api.vercel.com/v1/integrations/deploy/prj_abc123/xyz789`)

---

## ğŸ¯ ç¬¬ä¸‰æ­¥: é…ç½®Strapi Webhook (2åˆ†é’Ÿ)

### æ–¹æ³•A: é€šè¿‡ç®¡ç†åå° (æ¨è)

#### 3.1 ç™»å½•Strapi
è®¿é—®: http://47.251.126.80/admin

#### 3.2 åˆ›å»ºWebhook
1. å·¦ä¾§èœå• â†’ **Settings** â†’ **Webhooks**
2. ç‚¹å‡» **Create new webhook**
3. å¡«å†™é…ç½®:

**åŸºæœ¬ä¿¡æ¯:**
- **Name**: `Deploy to Vercel`
- **URL**: ç²˜è´´ç¬¬äºŒæ­¥å¤åˆ¶çš„Deploy Hook URL

**è§¦å‘äº‹ä»¶ (Events):**
å‹¾é€‰ä»¥ä¸‹äº‹ä»¶:
- âœ… `entry.create`
- âœ… `entry.update` 
- âœ… `entry.delete`
- âœ… `entry.publish`
- âœ… `entry.unpublish`

**Headers (å¯é€‰):**
```
Content-Type: application/json
```

4. ç‚¹å‡» **Save**

### æ–¹æ³•B: ä½¿ç”¨APIå‘½ä»¤

å¦‚æœç®¡ç†åå°ä¸å¯ç”¨ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

```bash
# æ›¿æ¢ YOUR_DEPLOY_HOOK_URL ä¸ºå®é™…çš„Hook URL
curl -X POST "http://47.251.126.80/api/webhooks" \
  -H "Authorization: Bearer 2980bc69d09c767b2ca2e1c211a285c9f48985775a3f1d1313025838a611abbfe6d892a29b3417407ddd798d69a9f67f063c27d13827c1765f96b4bc19601295ac11fb9552f4a16ede2745813e3b536827069875ae8c5089a36da57cf69d08b252093e2100e0cc88ac700ca6cd6ebd196f0002bd5fb8219222ed778f8858ad21" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Deploy to Vercel",
    "url": "YOUR_DEPLOY_HOOK_URL",
    "events": ["entry.create", "entry.update", "entry.delete", "entry.publish", "entry.unpublish"]
  }'
```

---

## ğŸ§ª ç¬¬å››æ­¥: æµ‹è¯•è‡ªåŠ¨éƒ¨ç½²

### 4.1 æµ‹è¯•Webhookè¿æ¥
```bash
# æ‰‹åŠ¨è§¦å‘éƒ¨ç½² (æ›¿æ¢ä¸ºæ‚¨çš„å®é™…URL)
curl -X POST "YOUR_DEPLOY_HOOK_URL" \
  -H "Content-Type: application/json" \
  -d '{"test": "manual trigger"}'
```

### 4.2 å®Œæ•´æµç¨‹æµ‹è¯•

#### æ­¥éª¤1: ä¿®æ”¹Strapiæ•°æ®
1. ç™»å½• http://47.251.126.80/admin
2. è¿›å…¥ **Content Manager** â†’ **Menu**
3. ç¼–è¾‘ä»»æ„èœå•é¡¹ (å¦‚: "é¦–é¡µ" â†’ "é¦–é¡µ-æµ‹è¯•")
4. ç‚¹å‡» **Save** å¹¶ **Publish**

#### æ­¥éª¤2: ç›‘æ§éƒ¨ç½²
1. ç«‹å³æŸ¥çœ‹Vercel Dashboard: https://vercel.com/dashboard
2. è¿›å…¥æ‚¨çš„é¡¹ç›®
3. æŸ¥çœ‹ **Deployments** æ ‡ç­¾
4. åº”è¯¥çœ‹åˆ°æ–°çš„éƒ¨ç½²å¼€å§‹ (çŠ¶æ€: Building â†’ Ready)

#### æ­¥éª¤3: éªŒè¯ç»“æœ
1. ç­‰å¾…éƒ¨ç½²å®Œæˆ (é€šå¸¸2-3åˆ†é’Ÿ)
2. è®¿é—®æ‚¨çš„ç½‘ç«™: `https://your-project.vercel.app`
3. æ£€æŸ¥èœå•æ˜¯å¦æ˜¾ç¤ºä¸º "é¦–é¡µ-æµ‹è¯•"
4. âœ… æˆåŠŸ! è‡ªåŠ¨æ›´æ–°å·²é…ç½®å®Œæˆ

---

## â±ï¸ é¢„æœŸæ—¶é—´çº¿

é…ç½®å®Œæˆåï¼Œæ¯æ¬¡æ•°æ®æ›´æ–°çš„æµç¨‹:

1. **0ç§’**: åœ¨Strapiä¸­ä¿®æ”¹å¹¶å‘å¸ƒå†…å®¹
2. **1-2ç§’**: Webhookè§¦å‘Verceléƒ¨ç½²
3. **30ç§’**: Vercelå¼€å§‹æ„å»º
4. **2-3åˆ†é’Ÿ**: æ„å»ºå®Œæˆï¼Œç½‘ç«™æ›´æ–°
5. **å®Œæˆ**: å…¨çƒCDNç¼“å­˜åˆ·æ–°

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1: Webhookæœªè§¦å‘
**æ£€æŸ¥æ¸…å•:**
- [ ] Webhook URLæ˜¯å¦æ­£ç¡®
- [ ] Strapiä¸­æ˜¯å¦å‹¾é€‰äº†æ­£ç¡®çš„äº‹ä»¶
- [ ] å†…å®¹æ˜¯å¦å·²"å‘å¸ƒ"(Published)

**è§£å†³æ–¹æ³•:**
```bash
# æ£€æŸ¥Webhooké…ç½®
curl -X GET "http://47.251.126.80/api/webhooks" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

### é—®é¢˜2: éƒ¨ç½²å¤±è´¥
**æ£€æŸ¥ä½ç½®:**
1. Vercel Dashboard â†’ é¡¹ç›® â†’ Deployments
2. ç‚¹å‡»å¤±è´¥çš„éƒ¨ç½²æŸ¥çœ‹é”™è¯¯æ—¥å¿—

**å¸¸è§åŸå› :**
- æ„å»ºå‘½ä»¤é”™è¯¯
- ä¾èµ–å®‰è£…å¤±è´¥
- APIè¿æ¥è¶…æ—¶

### é—®é¢˜3: ç½‘ç«™æœªæ›´æ–°
**å¯èƒ½åŸå› :**
- æµè§ˆå™¨ç¼“å­˜ (Ctrl+F5å¼ºåˆ¶åˆ·æ–°)
- CDNç¼“å­˜å»¶è¿Ÿ (ç­‰å¾…1-2åˆ†é’Ÿ)
- æ„å»ºè¿‡ç¨‹ä¸­APIè°ƒç”¨å¤±è´¥

---

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### 1. è®¾ç½®æ„å»ºé€šçŸ¥
åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­:
- **Settings** â†’ **Git** â†’ **Ignored Build Step**
- é…ç½®æ„å»ºæˆåŠŸ/å¤±è´¥çš„é‚®ä»¶é€šçŸ¥

### 2. ç¯å¢ƒå˜é‡é…ç½®
å¦‚æœéœ€è¦å…¶ä»–ç¯å¢ƒå˜é‡:
- **Settings** â†’ **Environment Variables**
- æ·»åŠ  `STRAPI_URL` å’Œ `STRAPI_TOKEN`

### 3. è‡ªå®šä¹‰åŸŸå
- **Settings** â†’ **Domains**
- æ·»åŠ æ‚¨çš„è‡ªå®šä¹‰åŸŸå

### 4. æ€§èƒ½ç›‘æ§
- å¯ç”¨ **Analytics** æŸ¥çœ‹ç½‘ç«™æ€§èƒ½
- è®¾ç½® **Speed Insights** ç›‘æ§åŠ è½½é€Ÿåº¦

---

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

é…ç½®æˆåŠŸåï¼Œæ‚¨åº”è¯¥çœ‹åˆ°:

âœ… **Verceléƒ¨ç½²çŠ¶æ€**: Ready  
âœ… **Webhookå“åº”**: 200 OK  
âœ… **æ„å»ºæ—¶é—´**: < 3åˆ†é’Ÿ  
âœ… **æ›´æ–°å»¶è¿Ÿ**: < 5åˆ†é’Ÿ  
âœ… **ç½‘ç«™å¯è®¿é—®**: å…¨çƒCDNåŠ é€Ÿ  

---

## ğŸš€ ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥:

1. **é‚€è¯·å›¢é˜Ÿæˆå‘˜**: è®©å†…å®¹ç¼–è¾‘è€…ç›´æ¥åœ¨Strapiä¸­ç®¡ç†å†…å®¹
2. **è®¾ç½®å¤šç¯å¢ƒ**: é…ç½®å¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
3. **æ·»åŠ æ›´å¤šå†…å®¹ç±»å‹**: äº§å“ã€æ–°é—»ã€æ¡ˆä¾‹ç­‰
4. **é…ç½®å¤‡ä»½**: å®šæœŸå¤‡ä»½Strapiæ•°æ®
5. **ç›‘æ§ä¼˜åŒ–**: è®¾ç½®æ€§èƒ½ç›‘æ§å’Œé”™è¯¯è¿½è¸ª

**æ­å–œï¼æ‚¨çš„ç½‘ç«™ç°åœ¨å·²ç»å®ç°äº†å†…å®¹ç®¡ç†ç³»ç»Ÿ(CMS)é©±åŠ¨çš„è‡ªåŠ¨æ›´æ–°ï¼** ğŸ‰ 